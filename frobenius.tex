\documentclass[12pt, a4paper]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{comment}
\usepackage{amsmath,amsthm, amssymb, bm, amsfonts}
\numberwithin{equation}{section}
\usepackage{tikz}
\usepackage{tikz-cd}
\usepackage{graphicx}
\usepackage{adjustbox}

\usetikzlibrary{matrix, positioning}
\usepackage{enumerate}
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{example}[definition]{Example}
\theoremstyle{plain}
\newtheorem{lemma}[definition]{Lemma}
\newtheorem{proposition}[definition]{Proposition}
\newtheorem{corollary}[definition]{Corollary}
\newtheorem{Conjecture}[definition]{Conjecture}
\newtheorem{theorem}[definition]{Theorem}
\theoremstyle{remark}
\newtheorem{remark}[definition]{Remark}
\title{Reflexive modules}
\author{Javier Herrero, Javier San Martin Martinez, Maša Žaucer}
\date{\today}

\begin{document}

\maketitle


\begin{abstract}
\end{abstract}

\section{Introduction}
Through this document we study necessary and sufficient conditions for a module to be reflexive over a Nakayama algebra. We recall that a module is reflexive over $R$ if $M^{**}\cong M$ where $M^{**}:=Hom_R(Hom_R(M,R),R).$ We recall that is sufficient to check that the module $M$ is torsionless and the dimension coincide.
\begin{remark}
    For classifying reflexive modules is enough to study indecomposable modules since any other module decomposes into direct sum of indecomposables and taking double duals commutes with direct sums, i.e. $\oplus_i M_i^{**}\cong (\oplus_iM_i)^{**}.$
\end{remark}
For a linear Nakayama algebra $A$ we know that the indecomposable modules are given by $s_{i,k}:=e_iA/J^kA$ where $J$ is the Jacobson Radical. This indecomposables fit nicely in the Auslander-Reiten quiver which we recall is determined by Dyck paths, using the Kupisch series which determines their Auslander-Reiten quiver. We want to use this combinatorial representation to give an explicit method to compute duals and eventually classify the indecomposable modules using the (co)Kupisch series. 

\section{Combinatorial method to compute duals}
We ilustrate our method with the following Auslander-Reiten quiver corresponding to the Nakayama algebra with Kupisch series $[4,3,2,3,2,1].$
\[
\scriptsize % Tamaño de fuente pequeño
\begin{tikzcd}[scale=0.5, column sep=2pt, row sep=2pt] % escala + separación mínima
  &&&&&&& \textcolor[rgb]{0.839,0.361,0.361}{{\bullet{s_{0,4}}}} \\
  && \textcolor[rgb]{0.839,0.361,0.361}{{\bullet {s_{3,3}}}} &&&& \textcolor[rgb]{0.839,0.361,0.361}{{\bullet{s_{1,3}}}} && {\bullet{s_{0,3}}} \\
  & \textcolor[rgb]{0.839,0.361,0.361}{{\bullet{s_{4,2}}}} && {\bullet{s_{3,2}}} && \textcolor[rgb]{0.839,0.361,0.361}{{\bullet{s_{2,2}}}} && {\bullet{s_{1,2}}} && {\bullet{s_{0,2}}} \\
  \textcolor[rgb]{0.839,0.361,0.361}{{\bullet{s_{5,1}}}} && {\bullet{s_{4,1}}} && {\bullet{s_{3,1}}} && {\bullet{s_{2,1}}} && {\bullet{s_{1,1}}} && {\bullet{s_{0,1}}}
  \arrow[color=cyan, from=1-8, to=2-9]
  \arrow[from=2-3, to=3-4]
  \arrow[color=cyan, from=2-7, to=1-8]
  \arrow[color=cyan, from=2-7, to=3-8]
  \arrow[color=cyan, from=2-9, to=3-10]
  \arrow[from=3-2, to=2-3]
  \arrow[from=3-2, to=4-3]
  \arrow[from=3-4, to=4-5]
  \arrow[from=3-6, to=2-7]
  \arrow[from=3-6, to=4-7]
  \arrow[from=3-8, to=2-9]
  \arrow[color=cyan, from=3-8, to=4-9]
  \arrow[from=3-10, to=4-11]
  \arrow[from=4-1, to=3-2]
  \arrow[from=4-3, to=3-4]
  \arrow[from=4-5, to=3-6]
  \arrow[from=4-7, to=3-8]
  \arrow[color=cyan, from=4-9, to=3-10]
\end{tikzcd}
\]
Moreover we can determine precisely the dual using the following remark and proposition.
\begin{remark}
    $Hom(s_{i,k},A)\cong Ae_i/J^wA$ where $w$ is the dimension of the dual. This means that the dual is indecomposable. We can further obtain more information about the dual by regarding the projective module $s_{i',k'}$ for the smallest $i'$ such that $Hom(s_{i,k},s_{i',k'})\neq 0$ then it is clear that $Hom(s_{i,k},R)\cong s_{i',w}.$ 
\end{remark}
With this it is clear that in order to compute the dual we should regard the number of projectives in the Dyck path, to which there exist non trivial maps from our module. We should find the one with the lowest $i$ which is the one more on the right in the picture. We realize this by the following geometrical construction. 

If we want to compute the dual of $s_{i,k}$ we draw a rectangle
 with one of the vertices in $s_{i,k}.$ We draw a line in direction right 
 down until we touch the $x$ axis and from there up right until 
 the quiver ends. We finish the rectangle by drawing two parallel
  lines in the obvious way. This method is ilustrated in the figure for the idecomposable module $s_{1,3}$ with the blue lines representing the rectangle. 
  By the properties of the Auslander-Reiten quiver the amount of projectives in the square corresponds to the dimension of the dual. We also know by the explanation above that the dual should have same first index as the vertex, non adjacent to the initial module.
\begin{proposition}
    For a Nakayama algebra with Kupisch series $c_i=\text{dim}(e_iA)$ and $d_i=\text{dim}(Ae_i)$, the dual of $s_{i,k}$ is 
	$s_{i-d_i+1,k+d_i-d_{i+k}}.$
\end{proposition}
\begin{proof}
    We first compute the vertices of the square. The right lower is $s_{i,1}$ we then consider the top right vertex which would be $s_{i-d_{i}+1,d_{i}}.$ From this it follows that the first index is indeed $i-d_i+1.$ We compute the dimension. Notice that in each diagonal lies $d_{i}-d_{i+1}+1$ elements. We then consider the $k$ diagonals and get:
   \begin{equation}
\label{eq:reachable}
\sum_{j=i}^{i+k-1} (d_j - d_{j+1} + 1) = d_i - d_{i+k} + k,
\end{equation}
\end{proof}
We remark that indeed this same method can be iterated just realizing that the Auslander-Reiten quiver associated to The Nakayama algebra by right multiplication is the same but with the arrows reversed. 
\begin{theorem}\label{Theorem reflexive modules}
	An idecomposable module $s_{i,k}$ is reflexive if and only if $d_{i+k}=c_{i+k-d_{i+k}}$ and $d_{i+k-1}\geq d_{i+k}$.
\end{theorem}
\begin{proof}
We first proof that is torsion free iff $d_{i+k-1}\geq d_{i+k}$ and then we prove that
the other condition correspond to the dimension counting.\\
We know that a module is torsion free if and only if it is contained
in a projective. If we look at the Auslander-Reiten quiver we realize that
this is the case if and only if it has a projective in the same diagonal(from left to right) which 
is true if and only if $d_{i+k-1}\geq d_{i+k}$.\\
We recall the computation of the first dual and we get $s_{i-d_i+1,d_i-d_{i+k}+k}$. 
To compute the second dual, we reverse the arrows and move to the left on the same Dyck path. By line we now mean the diagonal starting at index $j$ and going to the left and the length of line $j$ is $c_j$.
For convinience we will first compute the dual of an arbitrary module $M_{l,m}$ again, this time in the other direction. We will then enter the indices of the first dual obtained above.

To get the dimension of the dual, by duality between projectives and injectives, we need to count the injective modules reachable from $M_{l,m}$.
They lie on lines $j = l, l+1, \dots, l+m-1$ again and on line $j$ there are $c_j - c_{j+1} + 1$ of them.
We get that the dimension of the dual is given by
\begin{equation}
\label{eq:injectives}      
\sum_{j=l}^{l+m-1} (c_j - c_{j+1} + 1) = c_{l+m-1} - c_{l-1} + m.
\end{equation}

It remains to compute the first index of the dual.
First observe that from the module $M_{l,m}$ we can reach the dimension $1$ by going down $(m - 1)$-times. The left-most vertex then lies on the same line as the lower vertex and thus has index $l + m - 1$.
From the left most vertex we need to make additional steps down, until we reach the desired dimension of the dual.
The number of steps is $(c_{l+m-1} - dim)$, where $dim$ denotes the dimension of the dual.
Each step down increases the index by $1$, therefore we need to increase the index of left most vertex by $c_{l+m-1} - c_{l+m-1} + c_{l-1} - m = c_{l-1} - m$, where we took into account the dimension computed above.

We get that the first index of the dual is given by 
$$l + m - 1 + c_{l-1} - m = l + c_{l-1} - 1.$$

To get the indices of double dual, we just need to set 
\begin{align*}
    l &= i - d_i + 1, \\
    m &= d_i - d_{i+k} + k.
\end{align*}

We get that the double dual of module $M_{i,k}$ is given by the indices
\begin{align*}
    &i - d_i + c_{i - d_i}, \\
    &k + d_i - d_{i+k} + c_{i+k-{d_{i+k}}} - c_{i-d_i}.
\end{align*}

In order for the module $M_{i,k}$ to be reflexive, we need to have $i - d_i + c_{i - d_i} = i$ and $k + d_i - d_{i+k} + c_{i+k-{d_{i+k}}} - c_{i-d_i} = k$.
The first equation gives us $c_{i - d_i} = d_i$ and the second one, taking into account also the first equality, gives us $d_{i+k} = c_{i+k-{d_{i+k}}}$.
Since we just need to check the dimension is enough to check $d_{i+k}=c_{i+k-d_{i+k}}$.
\end{proof}
We study now the specialization of the formula above for the case of simple modules.
\begin{theorem}
    \label{simple_reflexive_iff_inequality}
    Let $s_{k,1}$ a non projective simple module. Then $s_k$ is reflexive
    if and only if $d_{k+1}\leq d_k \leq d_{k-1}$.
\end{theorem}
\begin{proof}
	We notice that $d_k\geq d_{k+1}$ is a specialization of the condition in Theorem \ref{Theorem reflexive modules}.
	The other inequality comes from a study of the dimension of the double dual. Notice that we need that the dual of our module has just one injective reachable.
	Moreover we know this injective should be in the same diagonal(from right to left) otherwise it will not be torsion free. The condition for such a diagonal to have just one injective is $d_{k}\leq d_{k-1}$ otherwise clearly there will be more injectives in that diagonal.
\end{proof}
\begin{theorem}
	Let $F$ the Lalanne-Kreweras involution. 
	Then the number of simple non projective reflexive modules is given by the statistics UUU in $F(D)$ with $D$ the Dyckpath defined by our quiver algebra.
\end{theorem}
\begin{proof}
% https://q.uiver.app/#q=WzAsNDIsWzEsMywiXFxidWxsZXQiXSxbMiwyLCJcXGJ1bGxldCJdLFszLDMsIlxcYnVsbGV0Il0sWzQsMiwiXFxidWxsZXQiXSxbNSwzLCJcXGJ1bGxldCJdLFs2LDIsIlxcYnVsbGV0Il0sWzcsMSwiXFxidWxsZXQiXSxbOCwyLCJcXGJ1bGxldCJdLFs5LDEsIlxcYnVsbGV0Il0sWzEwLDAsIlxcYnVsbGV0Il0sWzExLDEsIlxcYnVsbGV0Il0sWzEyLDIsIlxcYnVsbGV0Il0sWzEzLDMsIlxcYnVsbGV0Il0sWzE0LDIsIlxcYnVsbGV0Il0sWzE1LDEsIlxcYnVsbGV0Il0sWzE2LDAsIlxcYnVsbGV0Il0sWzE3LDEsIlxcYnVsbGV0Il0sWzE4LDIsIlxcYnVsbGV0Il0sWzE5LDMsIlxcYnVsbGV0Il0sWzIwLDIsIlxcYnVsbGV0Il0sWzIxLDMsIlxcYnVsbGV0Il0sWzAsMywiXFxidWxsZXQiLFswLDAsMTAwLDFdXSxbMjIsMywiXFxidWxsZXQiLFswLDAsMTAwLDFdXSxbNiw2LCJcXGJ1bGxldCJdLFs4LDQsIlxcYnVsbGV0IixbMzU2LDk1LDYwLDFdXSxbMTEsMywiXFxidWxsZXQiLFszNTYsOTUsNjAsMV1dLFsxNSwzLCJcXGJ1bGxldCIsWzM1Niw5NSw2MCwxXV0sWzE3LDMsIlxcYnVsbGV0IixbMzU2LDk1LDYwLDFdXSxbMTIsNCwiXFxidWxsZXQiXSxbMTMsNSwiXFxidWxsZXQiXSxbMTYsNCwiXFxidWxsZXQiXSxbMTQsNCwiXFxidWxsZXQiXSxbMTgsNCwiXFxidWxsZXQiXSxbMTksNSwiXFxidWxsZXQiXSxbMjAsNCwiXFxidWxsZXQiXSxbOSw1LCJcXGJ1bGxldCJdLFsxMCw0LCJcXGJ1bGxldCJdLFsyLDQsIlxcYnVsbGV0Il0sWzMsNSwiXFxidWxsZXQiXSxbNCw2LCJcXGJ1bGxldCJdLFs1LDcsIlxcYnVsbGV0Il0sWzcsNSwiXFxidWxsZXQiXSxbMjEsMjIsIiIsMCx7InN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMCwxXSxbMSwyLCJiXzkiXSxbMiwzXSxbMyw0LCJiXzgiXSxbNCw1XSxbNSw2XSxbNiw3LCJiXzciXSxbNyw4XSxbOCw5XSxbOSwxMCwiYl82Il0sWzEwLDExLCJiXzUiXSxbMTEsMTIsImJfNCJdLFsxMiwxM10sWzEzLDE0XSxbMTQsMTVdLFsxNSwxNiwiYl8zIl0sWzE2LDE3LCJiXzIiXSxbMTcsMTgsImJfMSJdLFsxOCwxOV0sWzE5LDIwLCJiXzAiXSxbMTEsMjUsIiIsMCx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzgsMjUsIiIsMCx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzEwLDI0LCIiLDAseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFs1LDI0LCIiLDAseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFsxNiwyNiwiIiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMTMsMjYsIiIsMCx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzE3LDI3LCIiLDAseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFsxNCwyNywiIiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMjYsMzAsImJfMiciXSxbMjksMzFdLFszMSwyNl0sWzI1LDI4LCJiXzQnIl0sWzI4LDI5LCJiXzMnIl0sWzMwLDI3XSxbMjcsMzIsImJfMSciXSxbMzIsMzMsImJfMCciXSxbMzMsMzRdLFszNCwyMF0sWzI0LDM1LCJiXzUnIl0sWzM1LDM2XSxbMzYsMjVdLFswLDM3LCJiXzknIiwyXSxbMzcsMzgsImJfOCciLDJdLFszOCwzOSwiYl83JyIsMl0sWzM5LDQwLCJiXzYnIiwyXSxbNDAsMjNdLFsyMyw0MV0sWzQxLDI0XV0=
  
\[
\begin{adjustbox}{max width=\textwidth}
\begin{tikzcd}
	&&&&&&&&&& \bullet &&&&&& \bullet \\
	&&&&&&& \bullet && \bullet && \bullet &&&& \bullet && \bullet \\
	&& \bullet && \bullet && \bullet && \bullet &&&& \bullet && \bullet &&&& \bullet && \bullet \\
	\textcolor{white}{\bullet} & \bullet && \bullet && \bullet &&&&&& \textcolor{rgb,255:red,250;green,56;blue,69}{\bullet} && \bullet && \textcolor{rgb,255:red,250;green,56;blue,69}{\bullet} && \textcolor{rgb,255:red,250;green,56;blue,69}{\bullet} && \bullet && \bullet & \textcolor{white}{\bullet} \\
	&& \bullet &&&&&& \textcolor{rgb,255:red,250;green,56;blue,69}{\bullet} && \bullet && \bullet && \bullet && \bullet && \bullet && \bullet \\
	&&& \bullet &&&& \bullet && \bullet &&&& \bullet &&&&&& \bullet \\
	&&&& \bullet && \bullet \\
	&&&&& \bullet
	\arrow["{b_6}", from=1-11, to=2-12]
	\arrow["{b_3}", from=1-17, to=2-18]
	\arrow["{b_7}", from=2-8, to=3-9]
	\arrow[from=2-10, to=1-11]
	\arrow[dashed, no head, from=2-10, to=4-12]
	\arrow["{b_5}", from=2-12, to=3-13]
	\arrow[dashed, no head, from=2-12, to=5-9]
	\arrow[from=2-16, to=1-17]
	\arrow[dashed, no head, from=2-16, to=4-18]
	\arrow["{b_2}", from=2-18, to=3-19]
	\arrow[dashed, no head, from=2-18, to=4-16]
	\arrow["{b_9}", from=3-3, to=4-4]
	\arrow["{b_8}", from=3-5, to=4-6]
	\arrow[from=3-7, to=2-8]
	\arrow[dashed, no head, from=3-7, to=5-9]
	\arrow[from=3-9, to=2-10]
	\arrow[dashed, no head, from=3-13, to=4-12]
	\arrow["{b_4}", from=3-13, to=4-14]
	\arrow[from=3-15, to=2-16]
	\arrow[dashed, no head, from=3-15, to=4-16]
	\arrow[dashed, no head, from=3-19, to=4-18]
	\arrow["{b_1}", from=3-19, to=4-20]
	\arrow["{b_0}", from=3-21, to=4-22]
	\arrow[no head, from=4-1, to=4-23]
	\arrow[from=4-2, to=3-3]
	\arrow["{b_9'}"', from=4-2, to=5-3]
	\arrow[from=4-4, to=3-5]
	\arrow[from=4-6, to=3-7]
	\arrow["{b_4'}", from=4-12, to=5-13]
	\arrow[from=4-14, to=3-15]
	\arrow["{b_2'}", from=4-16, to=5-17]
	\arrow["{b_1'}", from=4-18, to=5-19]
	\arrow[from=4-20, to=3-21]
	\arrow["{b_8'}"', from=5-3, to=6-4]
	\arrow["{b_5'}", from=5-9, to=6-10]
	\arrow[from=5-11, to=4-12]
	\arrow["{b_3'}", from=5-13, to=6-14]
	\arrow[from=5-15, to=4-16]
	\arrow[from=5-17, to=4-18]
	\arrow["{b_0'}", from=5-19, to=6-20]
	\arrow[from=5-21, to=4-22]
	\arrow["{b_7'}"', from=6-4, to=7-5]
	\arrow[from=6-8, to=5-9]
	\arrow[from=6-10, to=5-11]
	\arrow[from=6-14, to=5-15]
	\arrow[from=6-20, to=5-21]
	\arrow["{b_6'}"', from=7-5, to=8-6]
	\arrow[from=7-7, to=6-8]
	\arrow[from=8-6, to=7-7]
\end{tikzcd}
\end{adjustbox}
\]
    Let $D$ be the Dyck path, defined by our quiver algebra and $F(D)$ the Dyck path obtained by applying the Lalanne-Kreweras involution.
    We will present Dyck paths with sequences of $a$'s and $b$'s, denoting up-steps and down-steps respectively (we avoid usind $u$'s and $d$'s to avoid confusion with the notation of the Dyck path and cokupisch series).

    We will work with the geometric description of computing the Lalanne-Kreweras involution, described in (TODO: cite), in which we draw a southeast line from the midpoint of each $UU$ and a southeast line from the midpoint of each $DD$. 
    We then take the intersection of $i$-th southeast and $i$-th southwest line for each $i$. Reflecting the obtained points over $x$-axis and taking the reflected points as valleys gives a unique Dyck path $F(D)$, which is the Lalanne-Kreweras involution of $D$.
    For convinience of the argument we will consider $\tilde{F(D)}$ to be the Dyck path, obtained by reflecting $F(D)$ over the $x$-axis. Note that we obtain $\tilde{F(D)}$ by constructing the points as above and taking them as (inverted) valleys in (inverted) Dyck path.

    By theorem \ref{simple_reflexive_iff_inequality} we just need to show that the number of indices $k$ with $d_{k+1}\leq d_k \leq d_{k-1}$ in $D$ is equal to the number of occurances of three consequtive upsteps in $F(D)$ or equivalently three consequtive downsteps in $\tilde{F(D)}$.

    Denote by $a$ and $b$ the steps of $D$ and by $a'$ and $b'$ the steps of $\tilde{F(D)}$. There are exactly $n-1$ down-steps in $D$ and $n-1$ down-steps in $\tilde{F(D)}$.
    Index them from $1$ to $n-1$ from right to left, so that the indexing matches the indexing of the cokupisch series of the corresponding Nakayama algebra.

    Observe that there is an up-step between $b_i'$ and $b_{i-1}'$ in $\tilde{F(D)}$ if and only if there is a southwest line at index $i$. This is equivalent to the condition of having two consequtive down-steps $b_i$ and $b_{i-1}$ in $D$, meaning that $d_i \leq d_{i+1}$.
    Thus we have two consequtive down-steps $b_i'b_{i-1}'$ in $\tilde{F(D)}$ if and only if $d_{i+1} \leq d_i$.

    In conclusion, having three consequtive downsteps $b_{i+1}'b_i'b_{i-1}'$ in $\tilde{F(D)}$ is equivalent to having $d_{i+2} \leq d_{i+1} \leq d_{i}$ in $D$. Since the indices of $d_i$ run from $0$ to $n$ and the indices of $b_i$ from $0$ to $n-1$, the number of occurances coincide.

\end{proof}

\begin{corollary}
	The number of Nakayama algebras with $n$ simple modules and none of them reflexive except the projective one is given by the Motzkin numbers.
\end{corollary}
\begin{proof}
	We first notice that checking the number of modules with non simple non projective modules is the same as checking the number of Dyckpath of length $n$ with no $UUU$.
	We prove that this numbers follows the same recurrence relation as the Motzkin numbers.
\begin{equation}
	\label{eq:Motzkin} 
	M_n=M_{n-1}+\sum_{i=0}^{n-2}M_iM_{n-i-2}
\end{equation}
We notice that similar to the prove that the number of Dyckpath follows the catalan numbers,
we can describe any possible path by looking at the first time it touches the x-axis.
If it first touches the x-axis in $(2,0)$ then we obtain $M_{n-1}$. We then can consider the ones that touches first
the x-axis in $(2j,0)$ then we would have the amount of ways to arrive to $(2j,0)$ times $M_{n-j}$. 
Notice that to arrive to $(2j,0)$ without touching the x-axis we can consider the paths that go from 
$(1,1)$ to $(2j-1,1)$ without touching the $x$ axis. But since we are not allow to go three times
in arrow up we can consider without lost of generality that after that it goes up and then down.
In other words this will be like the paths from $(3,1)$ to $(2j-1,1)$ with the rule of not crossing the $x=1$ axis and not going three times in a row up.
This by induction will be $M_{j-2}$. We now notice that under a rearrengment of the indices we have deduced \ref{eq:Motzkin}
\end{proof}


\section{Dyck Paths and (312)-Avoiding Permutations}

Recall that there is a bijection between Dyck paths and $(312)$-avoiding permutations. The map sending Dyck paths to $(312)$-avoiding permutations under this bijection will be denoted by $S$. Moreover, the statistic that assigns to each $(312)$-avoiding permutations the number of double ascents within the permutation will be denoted by $R$. 

\begin{theorem}
	Let $A$ be a Nakayama algebra with Kupisch series $c_i = \dim{(e_i A)}$ and $D$ the corresponding Dyck path. Then the number of non-projective simple reflexive modules correspond precisely with $R(S(D))$.  
\end{theorem}

\begin{proof}
	Consider $D$ the Dyck path and $\sigma := S(D)$ its corresponding $(312)$-avoiding permutation. Then we will denote by $m_i$ the non-negative integer given by the amount of transpositions of the form $s_i$ that appear when decomposing $\sigma$ as transpositions as given by the bijection described above. Then one can consider the coKupisch series $d = \left ( d_i \right )_{i=0}^n$ corresponding to $D$. It is immediate to check the following equality: 
	\begin{equation*}
		d_k = 2 + m_{n-k+1} \quad 2 \leq k \leq n
	\end{equation*}
	while $d_0 = 1, d_1 = 2$. If we take $m_n = 0$ and $m_{n+1} = -1$, then actually the above equation still holds also for $0 \leq k \leq n$. \newline 

	We are then first going to consider an instance of a double ascent in $\sigma$, that is, $\sigma(k-1) < \sigma(k) < \sigma(k+1)$ for some $2 \leq k \leq n$. We then claim that the following inequalities hold: 
	\begin{equation*}
		m_{k-1} \leq m_k \leq m_{k+1} 
	\end{equation*}
	To simplify notation, we will denote $\sigma_i := \sigma(i)$. Then observe that if $l > \sigma_{k+1}$ and $l = \sigma_i$ for some $i$, then $k+1 < i$. If not, then we would have a $(312)$-pattern given by $\sigma_i \sigma_{k-1} \sigma_{k+1}$ hence a contradiction. In particular, it inmediately follows that $k+1 \leq \sigma_{k+1}$. For the same reason, we have that if $l > \sigma_k$ and $l = \sigma_i$ for some $i$, then $k < i$ and, hence, $k \leq \sigma_k$. \newline

	We will now give an explicit formula for $m_{k+1},m_k$. We claim first that 
	\begin{equation*}
		m_{k+1} = | \{ j : k + 1 < j \leq \sigma_{k+1} \} | = \sigma_{k+1} - (k+1)
	\end{equation*}
	To do this, we are going to count the amount of transpositions $s_{k+1}$ appear when decomposing $\sigma$ into transpositions via the explicit algorithm. Since for all of the $l > \sigma_{k+1}$ we have that they appear after the $k+1$ position in $\sigma$, we can assume without loss of generality that all of the $l > \sigma_{k+1}$ are in their corresponding position, i.e. $\sigma_l = l$ for $l > \sigma_{k+1}$, since it does not affect to counting the transposition $s_{k+1}$. Now we are going to study how the elements $j$ such that $k+1 < j \leq \sigma_{k+1}$ appear in the permutation $\sigma$. We make the following distinction: 
	\begin{enumerate}
		\item On the one hand, we can have that $j = \sigma_i$ for $i < k+1$.  
		\item Consider the set $\{ j : j = \sigma_i, i > k+1 \} = \{ j_1, \ldots,j_s \}$ where $j_1 > \cdots > j_s$. Then, we have that 
	\begin{equation*}
		\sigma = \left ( \cdots \sigma_{k-1} \sigma_k \sigma_{k+1} j_1 \cdots j_s \cdots | (\sigma_{k+1} + 1) \cdots n  \right )
	\end{equation*}
	To check this, just observe that for any $k+1 < j = \sigma_i \leq \sigma_{k+1}$ with $i > k+1$ and any $j' = \sigma_{i'}$ for which $i' < i$ it follows that $\sigma_{i+1} > j' > j > k+1$ by the $(312)$-avoiding condition. 
	\end{enumerate}
	We will then argue using the above observation that indeed we need to apply one $s_{k+1}$ for each $k+1 < j \leq \sigma_{k+1}$. If $j$ is of the first type of the distinction above, it is clear that we have to apply an $s_{k+1}$ by the condition $j > k+1$. On the other hand, for the $j$ from the second type, it is also clear that we use a $s_{k+1}$ transposition since these $j$'s orderly lie in the $k+1$-th position of the permutation. When all of the $k+1 < j$ have been ordered, clearly no more instances of $s_{k+1}$ appear in the decomposition, thus we have indeed proved that 
	\begin{equation*}
		m_{k+1} = \sigma_{k+1} - (k+1)
	\end{equation*} 
	If one checks above argument, the role of $\sigma_{k+1}$ can also be played by $\sigma_k$ and, hence, by the same reasoning: 
	\begin{equation*}
		m_k = \sigma_k - k
	\end{equation*}
	As $\pi_k < \pi_{k+1}$, it then follows that $m_k \leq m_{k+1}$ as desired. Finally, observe that  
	\begin{equation*}
		m_{k-1} \leq \pi_{k-1} - (k-1)
	\end{equation*}
	and thus $m_{k-1} \leq m_k$. Therefore, we have proved that
	\begin{equation*}
		d_{n-k+2} \leq d_{n-k+1} \leq d_{n-k}
	\end{equation*}
	and thus $S_{n-k+1}$ is a simple reflexive module by the criterion proved above. \newline

	Conversely, assume that $S_{n-k+1}$ is a simple reflexive module. Then by the same argument as above we have that 
	\begin{equation*}
		m_{k-1} \leq m_k \leq m_{k+1}
	\end{equation*}
	We then claim that $\sigma(k-1) < \sigma(k) < \sigma(k+1)$. To do this we will argue by induction on the lenght of the permutation $n$. When $n = 3$, then the only option is $m_1 \leq m_2 \leq m_3$ and this occurs if and only if $m_1 = m_2 = m_3 = 0$, that is, $\sigma$ is the identity. Hence $\sigma_{1} < \sigma_2 < \sigma_3$ as desired. Now assume that the claim holds for permutations of length $n$ and consider a permutation $\sigma \in S_n(312)$ such that $m_{k-1} \leq m_k \leq m_{k+1}$. If $k = n-1$, then since $m_n = 0$ it then follows that $m_{n-2} = m_{n-1} = 0$. In particular, $\sigma_n = n$ and hence we can apply induction hypothesis. Thus without loss of generality we may assume that $k < n-1$. Letting $\sigma_i = n$ for some $1 \leq i \leq n$, we have that whenever $i \geq k+1$ we can similarly apply induction hypothesis to conclude. We claim that this is the only situation we may encounter. For the sake of contradiction, assume that $i < k + 1$. Denote by $\sigma' \in S_{n-1}(312)$ the permutation obtained by placing $n$ in itss position and then restricting the permutation to $\{1,\ldots,n-1\}$. Similarly denote by $m_j'$ the amount of transpositions $s_j$ that appear when writing $\sigma'$ as a product of transpositions (in the previously described order). Then it is obvious that 
	\begin{equation*}
		m_{k-1} \leq m_k \leq m_{k+1} \Rightarrow m_{k-1}' \leq m_k' \leq m_{k+1}'
	\end{equation*} 
	Hence we may apply the induction hypothesis to $\sigma'$ to conclude that $\sigma'_{k-1} < \sigma'_k < \sigma'_{k+1}$. We may now distinguish two cases: 
	\begin{enumerate}
		\item $i \leq k-1$. In this case, it is clear that $\sigma_k = \sigma'_{k-1} < \sigma'_k = \sigma_{k+1}$. However, we then have that 
		\begin{equation*}
			\sigma = \left (\cdots n \cdots \sigma_{k-1} \sigma_k \sigma_{k+1} \cdots \right )
		\end{equation*}
		giving rise to the (312)-pattern $\sigma_i \sigma_k \sigma_{k+1}$, hence a contradiction.
		\item $i = k$ follows by a similar reasoning. In this case, we have that $\sigma_k' = \sigma_{k+1} < \sigma_{k+2} = \sigma'_{k+1}$. Therefore, we have that $\sigma_k \sigma_{k+1} \sigma_{k+2}$ is a $(312)$-pattern which again yields a contradiction.
	\end{enumerate}
	Having seen this, one concludes that $S_{n-k+1}$ is a simple reflexive module if and only if $\sigma(k-1) < \sigma(k) < \sigma(k+1)$, concluding with the desired bijection. 
\end{proof}

\bibliographystyle{plain} 
\bibliography{refs}

\end{document}